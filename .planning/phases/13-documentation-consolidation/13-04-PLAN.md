---
phase: 13-documentation-consolidation
plan: 04
type: execute
wave: 2
depends_on: [13-01, 13-02]
files_modified:
  - docs/architecture/*.md
  - docs/reference/*.md
autonomous: true

must_haves:
  truths:
    - "All ProjectTT Excel files converted to Markdown tables"
    - "Multi-sheet workbooks have section per sheet"
    - "Table formatting preserved where possible"
  artifacts:
    - path: "docs/architecture/schemas.md"
      provides: "Database schema documentation from Schemas_20260114.xlsx"
      min_lines: 100
    - path: "docs/reference/"
      provides: "Reference tables from Excel files"
      min_lines: 50
  key_links:
    - from: "docs/**/*.md"
      to: "Excel source"
      via: "metadata note"
      pattern: "Converted from:.*\\.xlsx"
---

<objective>
Convert all ProjectTT Excel files (.xlsx) to Markdown tables.

Purpose: Transform Excel spreadsheets into readable Markdown tables integrated with ta_lab2's docs/ structure. Each sheet becomes a section with table formatting preserved.
Output: Markdown files with tables in docs/architecture/ and docs/reference/
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/13-documentation-consolidation/13-CONTEXT.md
@.planning/phases/13-documentation-consolidation/13-RESEARCH.md

# Prior plan outputs
@.planning/phases/13-documentation-consolidation/13-01-SUMMARY.md
@.planning/phases/13-documentation-consolidation/13-02-SUMMARY.md
@.planning/phases/13-documentation-consolidation/projecttt_inventory.json

# Conversion utilities
@src/ta_lab2/tools/docs/convert_excel.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Convert key Excel files to Markdown</name>
  <files>docs/architecture/*.md, docs/reference/*.md</files>
  <action>
Convert important ProjectTT Excel files using convert_excel_to_markdown.

1. Load inventory and filter for .xlsx files

2. Priority conversions (architecture-related):
   - Schemas_20260114.xlsx (183KB) -> docs/architecture/schemas.md
     - Critical: database schema documentation
   - EMA Study.xlsx (104KB) -> docs/features/emas/ema-study.md
     - EMA analysis and parameters
   - EMA_Alpha_LUT_Comparisson.xlsx -> docs/features/emas/ema-alpha-comparison.md

3. Reference/supporting conversions:
   - db_schemas_keys.xlsx -> docs/architecture/db-keys.md
   - assets_exchanges_info.xlsx -> docs/reference/exchanges-info.md
   - ta_lab2_TimeFramesChart_20251111.xlsx -> docs/reference/timeframes-chart.md
   - new_12wk_plan_table.xlsx -> docs/planning/12-week-plan-table.md

4. Lower priority (can skip if very complex):
   - compare_3_emas'.xlsx (complex comparison)
   - TV_DataExportPlay.xlsx (1.5MB - large, likely data export)
   - github_code_frequency.xlsx
   - ChatGPT_Convos_Manually_Desc.xlsx (conversation tracking)
   - time_scrap.xlsx

5. For each conversion:
   - Use convert_excel_to_markdown()
   - Each sheet becomes H2 section
   - Add source note: "*Converted from: {filename}*"
   - Handle unnamed columns gracefully

6. Skip temp files (~$*.xlsx) - already filtered in discovery
  </action>
  <verify>
    ls docs/architecture/schemas.md docs/features/emas/ema-study.md 2>/dev/null || echo "Check conversion paths"
  </verify>
  <done>
    - Key Excel files converted to Markdown tables
    - Schemas documentation available in docs/architecture/
    - EMA studies available in docs/features/emas/
    - Each file has source note indicating original Excel
  </done>
</task>

<task type="auto">
  <name>Task 2: Handle complex Excel files</name>
  <files>docs/reference/*.md</files>
  <action>
Review and handle Excel files with complex formatting.

1. Identify files that may not convert cleanly:
   - Files with merged cells
   - Files with formulas (will show calculated values)
   - Files with colors/conditional formatting (lost in conversion)
   - Very large files (>500KB)

2. For complex files, apply three-tier fallback strategy:
   - Tier 1: Best effort conversion (convert what's possible)
   - Tier 2: Simplify structure (unmerge implied, remove formatting)
   - Tier 3: Flag for manual review (add TODO comment in output)

3. Add conversion notes to affected files:
   ```markdown
   <!-- Note: This table was converted from Excel with complex formatting.
        Some merged cells or conditional formatting may not be preserved.
        See original: .archive/documentation/YYYY-MM-DD/{filename} -->
   ```

4. For TV_DataExportPlay.xlsx (1.5MB):
   - This is likely a data export, not documentation
   - Convert only if it contains useful reference tables
   - Otherwise, skip and note in conversion log

5. Track conversion quality:
   - "clean" - converted perfectly
   - "simplified" - some formatting lost
   - "partial" - only some sheets converted
   - "skipped" - too complex or not documentation
  </action>
  <verify>
    python -c "from pathlib import Path; md_files = list(Path('docs').rglob('*.md')); excel_count = len([f for f in md_files if 'xlsx' in f.read_text().lower()]); print(f'{excel_count} files reference Excel sources')"
  </verify>
  <done>
    - All convertible Excel files processed
    - Complex files have conversion notes
    - Quality tracking for each conversion
    - Large/data-only files appropriately skipped
  </done>
</task>

</tasks>

<verification>
All verification commands must pass:

```bash
# Key conversions exist
ls docs/architecture/schemas.md

# Tables properly formatted (check for | characters)
grep -l "|" docs/architecture/schemas.md docs/features/emas/ema-study.md 2>/dev/null || echo "Check table format"

# Source notes present
grep -l "Converted from:" docs/architecture/schemas.md 2>/dev/null || echo "Check source notes"
```
</verification>

<success_criteria>
- [ ] Schemas_20260114.xlsx converted to docs/architecture/schemas.md
- [ ] EMA Study.xlsx converted to docs/features/emas/ema-study.md
- [ ] Multi-sheet workbooks have H2 section per sheet
- [ ] Markdown tables properly formatted with | separators
- [ ] Complex files have conversion notes
- [ ] Large data-only files skipped or noted
</success_criteria>

<output>
After completion, create `.planning/phases/13-documentation-consolidation/13-04-SUMMARY.md`
</output>
