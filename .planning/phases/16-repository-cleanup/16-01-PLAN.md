---
phase: 16-repository-cleanup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .archive/temp/manifest.json
  - .archive/scripts/manifest.json
autonomous: true

must_haves:
  truths:
    - "Root directory contains no loose Python scripts except essential tooling"
    - "Temp files (*.csv, *.txt, *.patch, *.msi) archived with manifest tracking"
    - "Corrupted path directories cleaned up"
    - "Redundant config files (openai_config_2.env) archived"
  artifacts:
    - path: ".archive/temp/2026-02-03/manifest.json"
      provides: "Manifest for archived temp files"
      contains: "sha256_checksum"
    - path: ".archive/scripts/2026-02-03/manifest.json"
      provides: "Manifest for archived scripts"
      contains: "sha256_checksum"
  key_links:
    - from: "archived files"
      to: "manifest.json"
      via: "SHA256 checksums"
      pattern: "sha256_checksum.*[a-f0-9]{64}"
---

<objective>
Archive root directory clutter (temp files, loose scripts, corrupted paths)

Purpose: Clean root directory to contain only essential files per CLEAN-01 requirement
Output: Minimal root directory with archived temp files tracked in manifests
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/16-repository-cleanup/16-CONTEXT.md
@.planning/phases/16-repository-cleanup/16-RESEARCH.md

# Archive infrastructure
@src/ta_lab2/tools/archive/__init__.py
@.archive/00-README.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Archive temp files and corrupted path directories</name>
  <files>
    .archive/temp/2026-02-03/
    .archive/temp/manifest.json
  </files>
  <action>
Archive the following temp files from root to `.archive/temp/2026-02-03/`:

**Large CSV files (audit artifacts):**
- ema_audit.csv (2.7 MB)
- ema_expected_coverage.csv
- ema_samples.csv (112 MB)
- price_bars_audit.csv
- price_bars_samples.csv (14 MB)
- structure.csv

**Text/patch files:**
- diff.txt
- full_diff.patch
- full_git_log.txt
- structure.txt
- structure.json
- src_structure.json
- top_exchanges.txt
- api_server.log

**Binary files:**
- pandoc-3.8.3-windows-x86_64.msi (41 MB)

**Corrupted path directories (Windows path issues):**
- `C:UsersasafiAppDataLocalTempclaudeC--Users-asafi-Downloads-ta-lab2c83d074d-ffff-4260-96b8-93d1abaa9042scratchpadplan-04-02.txt`
- `C:UsersasafiAppDataLocalTempclaudeC--Users-asafi-Downloads-ta-lab2c83d074d-ffff-4260-96b8-93d1abaa9042scratchpadplan-04-03.txt`
- `C:UsersasafiAppDataLocalTempclaudeC--Users-asafi-Downloads-ta-lab2c83d074d-ffff-4260-96b8-93d1abaa9042scratchpadplan-04-04.txt`
- Directory: `C:UsersasafiDownloadsta_lab2docs`
- Directory: `C:UsersasafiDownloadsta_lab2testsintegration`
- Directory: `C:UsersasafiDownloadsta_lab2teststoolsdata_tools`

**Other temp artifacts:**
- `-k` (empty file with dash name)
- `nul` (Windows null device artifacts)
- `memory_enrich_run_manifest.json`
- `srcta_lab2toolsdocs__init__.py` (corrupted path)
- `testsorchestrator__init__.py` (corrupted path)
- `testsorchestratortest_validation.py` (corrupted path)

For each file/directory:
1. Use `git mv` for tracked files to preserve history
2. Use `git rm` + manual move for untracked files
3. Compute SHA256 checksum before move using `ta_lab2.tools.archive.compute_file_checksum()`
4. Update manifest.json with FileEntry for each archived item

Create manifest following existing schema (see .archive/data_tools/2026-02-03/manifest.json).
  </action>
  <verify>
- `ls` root directory shows no *.csv, *.txt, *.patch, *.msi files
- `ls .archive/temp/2026-02-03/` shows archived files
- `cat .archive/temp/manifest.json` shows valid JSON with checksums
- `git log --follow .archive/temp/2026-02-03/ema_audit.csv` shows history preserved
  </verify>
  <done>
Temp files archived to .archive/temp/2026-02-03/ with manifest tracking. Root directory contains no large temp files or corrupted path artifacts.
  </done>
</task>

<task type="auto">
  <name>Task 2: Archive loose Python scripts from root</name>
  <files>
    .archive/scripts/2026-02-03/
    .archive/scripts/manifest.json
  </files>
  <action>
Review and archive loose Python scripts from root directory:

**Scripts to archive (one-off runners/utilities):**
- run_btc.py (BTC pipeline runner)
- run_btc_genesis.py (BTC genesis runner)
- run_spyder_menu.py (Spyder IDE menu)
- spyder_run_file_2025_11_02.py (dated Spyder script)
- shorter_spyder_run_file_2025_11_02.py (dated Spyder script)
- run_migration.py (memory migration runner)
- run_migration_fixed.py (fixed migration runner)
- fix_qdrant_persistence.py (Qdrant fix)
- count_chromadb_memories.py (memory count utility)
- generate_structure_docs.py (structure doc generator)

**Conversion scripts (Phase 13 utilities):**
- convert_docx_to_txt.py
- convert_excel_files.py
- convert_projecttt_batch.py

**Test scripts (should be in tests/):**
- test_cal_anchor_refactored.py
- test_cal_refactored.py
- test_multi_tf_refactored.py

**Phase 14 memory script:**
- update_phase14_memory.py

**Config file (redundant):**
- openai_config_2.env (keep openai_config.env as primary)
- config.py (if redundant with pyproject.toml/configs/)

For each:
1. Examine purpose (read first 20 lines for docstring/comments)
2. Determine category: scripts/runners/, scripts/utilities/, scripts/tests/, scripts/deprecated/
3. Archive with `git mv` to `.archive/scripts/2026-02-03/{category}/`
4. Record in manifest with archive_reason explaining decision

**Do NOT archive (essential root files):**
- pyproject.toml, pytest.ini, mkdocs.yml
- README.md, CHANGELOG.md, CONTRIBUTING.md, SECURITY.md
- .gitignore, .gitattributes
- openai_config.env, db_config.env, .env.example (primary configs)
- setup_qdrant_server.bat, start_qdrant_server.bat (server setup)
  </action>
  <verify>
- `ls *.py` in root shows no Python scripts
- `ls .archive/scripts/2026-02-03/` shows categorized subdirectories
- `cat .archive/scripts/manifest.json` shows valid JSON with reasons
  </verify>
  <done>
Loose Python scripts archived to .archive/scripts/2026-02-03/ with category organization. Root contains only essential config files.
  </done>
</task>

<task type="auto">
  <name>Task 3: Clean up temp directories from root</name>
  <files>
    .archive/temp/2026-02-03/
  </files>
  <action>
Archive or remove untracked temp directories from root:

**Directories to examine and archive:**
- connectivity/ (examine contents - if valuable, archive; if empty, remove)
- media/ (likely conversion assets - archive to .archive/temp/)
- memory/ (examine - if duplicate of .memory/, archive)
- skills/ (examine contents - if AI skills, archive)

**Directories to archive:**
- out/ (output directory)
- github/ (GitHub-related artifacts)
- research/ (research artifacts)
- artifacts/ (already has db_schema_snapshot.md files)
- audits/ (audit results)
- scripts/ (if exists and redundant)
- data/ (data directory)

**Corrupted path directories (move contents or archive):**
- `srcta_lab2scriptsbacktests`
- `srcta_lab2toolsdocs`
- `sqlbacktests`
- `testsbacktests`
- `.planningphases11-memory-preparationvalidation`

For each directory:
1. Check if tracked in git (`git ls-files {dir}/`)
2. If tracked: `git mv` to .archive/temp/2026-02-03/{dir}/
3. If untracked: Copy contents to .archive/, then delete source
4. Add directory listing to manifest

**Keep in root:**
- .archive/ (archive directory)
- .benchmarks/ (pytest benchmarks)
- .claude/ (Claude config)
- .gemini/ (Gemini config)
- .github/ (GitHub workflows)
- .memory/ (memory state)
- .planning/ (GSD planning)
- .pytest_cache/ (pytest cache)
- .venv/, .venv311/ (virtual environments)
- .vscode/ (VS Code config)
- configs/ (configuration files)
- docs/ (documentation)
- sql/ (SQL scripts)
- src/ (source code)
- tests/ (test files)
  </action>
  <verify>
- `ls -d */` in root shows only essential directories
- No corrupted path directories remain
- Archived directories tracked in manifest
  </verify>
  <done>
Temp directories archived or cleaned. Root directory contains only essential directories per best practices.
  </done>
</task>

</tasks>

<verification>
Phase 16 Plan 01 verification:

1. Root directory cleanliness:
   ```bash
   ls -la | wc -l  # Should be significantly reduced
   ls *.py 2>/dev/null | wc -l  # Should be 0
   ls *.csv 2>/dev/null | wc -l  # Should be 0
   ```

2. Archive integrity:
   ```bash
   cat .archive/temp/manifest.json | python -m json.tool > /dev/null  # Valid JSON
   cat .archive/scripts/manifest.json | python -m json.tool > /dev/null  # Valid JSON
   ```

3. Git history preserved (sample):
   ```bash
   git log --follow --oneline .archive/temp/2026-02-03/ema_audit.csv | wc -l  # >= 2
   ```
</verification>

<success_criteria>
- Root directory contains only essential files: README.md, pyproject.toml, mkdocs.yml, pytest.ini, CHANGELOG.md, CONTRIBUTING.md, SECURITY.md, .gitignore, .gitattributes, LICENSE (if exists)
- No loose Python scripts in root (all archived)
- No temp files (*.csv, *.txt, *.patch, *.msi) in root
- No corrupted path directories/files remain
- Archived files tracked in .archive/temp/manifest.json and .archive/scripts/manifest.json
- Git history preserved for archived tracked files
</success_criteria>

<output>
After completion, create `.planning/phases/16-repository-cleanup/16-01-SUMMARY.md`
</output>
