---
phase: 15-economic-data-strategy
plan: 03
type: execute
wave: 3
depends_on: ["15-02"]
files_modified: []
autonomous: true
user_setup: []

must_haves:
  truths:
    - "Memory queries return archive locations for fredtools2 and fedtools2"
    - "Phase 15 snapshot queryable with completion metadata"
    - "Archive decision documented in memory for future reference"
  artifacts: []
  key_links:
    - from: "memory query"
      to: "archive path"
      via: "archived_to relationship"
      pattern: "archived_to"
---

<objective>
Update memory with archive relationships and phase snapshot

Purpose: Enable semantic search for archived economic data packages. Future queries like "Where is fredtools2?" should return archive location. Phase 15 completion snapshot provides audit trail.

Output: Archive relationship memories for both packages, phase snapshot with requirements tracking, verification of memory queries.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/15-economic-data-strategy/15-RESEARCH.md

# Memory update patterns from Phase 14
@.planning/phases/14-tools-integration/14-10-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create archive memory records</name>
  <files></files>
  <action>
Create Python script to add archive memories to Mem0 following Phase 14 patterns.

**Script: update_phase15_memory.py**
```python
"""Update memory with Phase 15 archive relationships."""
import os
from datetime import datetime
from pathlib import Path

# Load API key
from dotenv import load_dotenv
load_dotenv("openai_config.env")

from mem0 import Memory

# Initialize Mem0 client
config = {
    "llm": {"provider": "openai", "config": {"model": "gpt-4o-mini"}},
    "embedder": {"provider": "openai"},
    "vector_store": {
        "provider": "qdrant",
        "config": {"host": "localhost", "port": 6333, "collection_name": "ta_lab2_memories"}
    }
}
client = Memory.from_config(config)
user_id = "ta_lab2_codebase"

# Archive records for both packages
archives = [
    {
        "name": "fredtools2",
        "source": "/c/Users/asafi/Downloads/fredtools2",
        "target": ".archive/economic_data/2026-02-03/fredtools2/",
        "description": "PostgreSQL-backed FRED data ingestion with CLI",
        "lines": 167,
        "files": 6,
        "reason": "Zero usage in ta_lab2, ecosystem alternatives (fredapi) superior"
    },
    {
        "name": "fedtools2",
        "source": "/c/Users/asafi/Downloads/fedtools2",
        "target": ".archive/economic_data/2026-02-03/fedtools2/",
        "description": "ETL consolidation of Federal Reserve policy target datasets",
        "lines": 659,
        "files": 11,
        "reason": "Zero usage in ta_lab2, ecosystem alternatives (fredapi, fedfred) superior"
    }
]

# Add archive memories
for pkg in archives:
    memory_text = (
        f"Package {pkg['name']} was archived in Phase 15 (Economic Data Strategy). "
        f"Original location: {pkg['source']}. "
        f"Archive location: {pkg['target']}. "
        f"Description: {pkg['description']}. "
        f"Size: {pkg['lines']} lines in {pkg['files']} Python files. "
        f"Archive reason: {pkg['reason']}. "
        f"Ecosystem alternatives: fredapi (recommended), fedfred (async support). "
        f"Relationship: archived_to"
    )

    metadata = {
        "type": "archive_relationship",
        "package_name": pkg["name"],
        "source_path": pkg["source"],
        "target_path": pkg["target"],
        "phase": "15-economic-data-strategy",
        "action": "archived",
        "reason": pkg["reason"],
        "relationship": "archived_to",
        "timestamp": datetime.now().isoformat()
    }

    result = client.add(memory_text, user_id=user_id, metadata=metadata, infer=False)
    print(f"Added archive memory for {pkg['name']}: {result}")

print(f"Created {len(archives)} archive memories")
```

**Key points:**
- Use infer=False for batch performance (Phase 11/14 pattern)
- Include archived_to relationship type
- Store source_path and target_path for queryability
- Tag with phase and action metadata
  </action>
  <verify>
Run script and check output shows both memories added successfully.
  </verify>
  <done>Archive relationship memories created for fredtools2 and fedtools2</done>
</task>

<task type="auto">
  <name>Task 2: Create phase 15 completion snapshot</name>
  <files></files>
  <action>
Add phase snapshot memory to Mem0 (continuing script or separate operation):

```python
# Phase 15 completion snapshot
snapshot_text = (
    "Phase 15 (Economic Data Strategy) completed on 2026-02-03. "
    "Decision: Archive both fredtools2 and fedtools2 packages. "
    "Rationale: Zero usage in ta_lab2 codebase, ecosystem alternatives (fredapi, fedfred) superior. "
    "Packages archived to .archive/economic_data/2026-02-03/ with SHA256 checksums. "
    "Documentation includes manifest.json, 00-README.md, and INTEGRATION_GUIDE.md. "
    "Requirements satisfied: ECON-01 (function inventory), ECON-02 (decision documented), "
    "ECON-03 (archive implementation), MEMO-13 (moved_to relationships), MEMO-14 (phase snapshot). "
    "Archive totals: 2 packages, ~826 lines of code, 17+ Python files. "
    "Ecosystem recommendation: Use fredapi>=0.5.2 or fedfred>=1.0 for future economic data needs."
)

snapshot_metadata = {
    "type": "phase_snapshot",
    "phase": "15-economic-data-strategy",
    "phase_name": "Economic Data Strategy",
    "status": "complete",
    "decision": "archive",
    "packages_archived": 2,
    "total_lines": 826,
    "requirements_satisfied": ["ECON-01", "ECON-02", "ECON-03", "MEMO-13", "MEMO-14"],
    "archive_path": ".archive/economic_data/2026-02-03/",
    "ecosystem_alternatives": ["fredapi", "fedfred"],
    "timestamp": datetime.now().isoformat()
}

result = client.add(snapshot_text, user_id=user_id, metadata=snapshot_metadata, infer=False)
print(f"Created phase snapshot: {result}")
```
  </action>
  <verify>
Script completes successfully with snapshot creation confirmed.
  </verify>
  <done>Phase 15 completion snapshot created with requirements tracking</done>
</task>

<task type="auto">
  <name>Task 3: Verify memory queries work</name>
  <files></files>
  <action>
Test that memory queries return correct results:

```python
# Verification queries
queries = [
    ("Where is fredtools2 now?", "Should return archive path"),
    ("What happened to fedtools2?", "Should return archive decision"),
    ("Phase 15 economic data strategy", "Should return phase snapshot"),
    ("FRED API packages archived", "Should return both packages")
]

print("\n=== Memory Query Verification ===\n")

for query, expected in queries:
    results = client.search(query, user_id=user_id, limit=3)

    # Handle dict vs list response format
    if isinstance(results, dict):
        results = results.get("results", [])

    print(f"Query: {query}")
    print(f"Expected: {expected}")
    print(f"Results: {len(results)} found")
    if results:
        for r in results[:2]:
            memory = r.get("memory", r.get("text", "No text"))
            print(f"  - {memory[:100]}...")
    print()

print("Memory verification complete")
```

All queries should return relevant results containing:
- fredtools2 query: archive path .archive/economic_data/2026-02-03/fredtools2/
- fedtools2 query: archive decision and rationale
- Phase 15 query: completion snapshot with requirements
- FRED API query: both archived packages
  </action>
  <verify>
All verification queries return relevant results with archive information.
  </verify>
  <done>Memory queries verified - archive locations and phase completion queryable</done>
</task>

</tasks>

<verification>
1. Archive memories exist for both fredtools2 and fedtools2
2. Phase 15 snapshot exists with completion metadata
3. Query "Where is fredtools2?" returns archive path
4. Query "Phase 15" returns completion snapshot
5. All memories tagged with phase and relationship metadata
</verification>

<success_criteria>
- 2 archive relationship memories created (fredtools2, fedtools2)
- 1 phase snapshot memory created with requirements tracking
- Memory queries return correct archive locations
- MEMO-13 (moved_to/archived_to relationships) satisfied
- MEMO-14 (phase snapshot) satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/15-economic-data-strategy/15-03-SUMMARY.md`
</output>
